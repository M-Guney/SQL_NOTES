--NTILE FONK
-- Listeyi gruplandýrmada kullanýlýr

-- BÖLME ÝÞLEMÝ YAPAR
-- Ýçine girilen sayý kadar bütün çýktýyý sayý kadar böler

Select RANK() OVER
		(ORDER BY UNITPRICE ) AS RANK_ ,
		ROW_NUMBER() OVER
		(ORDER BY UNITPRICE ) AS ROWNUMBER ,
		DENSE_RANK() OVER
		(ORDER BY UNITPRICE ) AS DENSE_RANK_,
		NTILE(100) OVER
		(ORDER BY UNITPRICE ) AS NTILE5_,*
FROM ITEMS

/* Bu örnekte bütün ürünleri birim satýþ fiyatýna küçükten büyüðe olacak þekilde 100 gruba ayýrýldý.

1	1	1	1	1	MARKA-154	000001	KONSERVE KAPAK	EV	MUTFAK EÞYA GEREÇLERÝ	METAL EL ALETLERÝ	1,2
2	2	2	1	9	MARKA-210	000009	ÇUBUK KRAKER 36 GR	GIDA	BÜSKÝVÝ ÇEREZ	BÜSKÝVÝ	2
2	3	2	1	574	MARKA-147	000574	SU 0,5LT	ÝÇECEK	SU MADENSUYU	SU	2
2	4	2	1	810	MARKA-210	000810	GEVREK COCO POPS 15GR	SÜT KAHVALTILIK	KAHVALTILIK	GEVREK MÜSLÝ	2
2	5	2	1	1268	MARKA-147	001268	SÜT TOZU 5 GR	ÝÇECEK	ÇAY KAHVE	SÜTTOZU KREMA	2
6	6	3	1	205	MARKA-113	000205	KAHVE 3 ÝN 1 ARADA 18 GR	ÝÇECEK	ÇAY KAHVE	KAHVE	2,24
7	7	4	1	1101	MARKA-210	001101	TAVUK BULYON2 LÝ	GIDA	CORBA BULYON	BULYONLAR	2,64
8	8	5	1	222	MARKA-210	000222	KAHVE 3 U 1	ÝÇECEK	ÇAY KAHVE	KAHVE	2,8
8	9	5	1	271	MARKA-147	000271	KAHVE  BOL KAHVE TADI 18 GR	ÝÇECEK	ÇAY KAHVE	KAHVE	2,8
10	10	6	1	154	MARKA-210	000154	DOÐAL MÝNERALLI SU 200ML	ÝÇECEK	SU MADENSUYU	MADENSUYU	3,2
10	11	6	1	951	MARKA-59	000951	PUDÝNG MUZLU 6 LÝ	SÜT KAHVALTILIK	SÜTLÜ TATLILAR DONDURMA	SÜTLÜ TATLILAR	3,2
10	12	6	1	963	MARKA-160	000963	AYRAN 200GR	ÝÇECEK	GÜNLÜK ÝÇECEK	AYRAN 	3,2
13	13	7	1	947	MARKA-107	000947	TUZ 750 GR	GIDA	TUZ BAHARAT	TUZ	3,6
13	14	7	1	132	MARKA-210	000132	SALEP TEKLÝ	ÝÇECEK	ÇAY KAHVE	TOZ ÝÇECEKLER	3,6
--------------- 14 ROW
13	15	7	2	558	MARKA-87	000558	SAKIZ 5LÝ DAMLA	GIDA	SAKIZ SEKERLEME	SAKIZ	3,6
16	16	8	2	300	MARKA-82	000300	KEK ÇÝKOLATA KAPLAMA 50 GR.	GIDA	BÜSKÝVÝ ÇEREZ	KEK	4
16	17	8	2	338	MARKA-03	000338	PLASTÝK ÇATAL 10 ADET	EV	MUTFAK EÞYA GEREÇLERÝ	MUTFAK SARF MALZEMESÝ	4
16	18	8	2	339	MARKA-03	000339	PLASTÝK KAÞIK 10 ADET	EV	MUTFAK EÞYA GEREÇLERÝ	MUTFAK SARF MALZEMESÝ	4
16	19	8	2	390	MARKA-82	000390	KEK LÝMON KAPLAMA 50 GR.	GIDA	BÜSKÝVÝ ÇEREZ	KEK	4
16	20	8	2	391	MARKA-82	000391	KEK MUZLU 50 GR.	GIDA	BÜSKÝVÝ ÇEREZ	KEK	4
16	21	8	2	13	MARKA-210	000013	MÝNÝ ÇÝKOLATA 3 LÜ	GIDA	BÜSKÝVÝ ÇEREZ	BÜSKÝVÝ	4
16	22	8	2	8	MARKA-210	000008	PEYNÝRLÝ ÇUBUK 50 GR	GIDA	BÜSKÝVÝ ÇEREZ	BÜSKÝVÝ	4
16	23	8	2	23	MARKA-210	000023	TAT 32 GR	GIDA	BÜSKÝVÝ ÇEREZ	BÜSKÝVÝ	4
16	24	8	2	24	MARKA-210	000024	8 KEK ÇÝKOLATA+MÜZ 50GR	GIDA	BÜSKÝVÝ ÇEREZ	KEK	4
16	25	8	2	25	MARKA-210	000025	KEK POTÝ KAKAOLU 48GR	GIDA	BÜSKÝVÝ ÇEREZ	KEK	4
16	26	8	2	26	MARKA-210	000026	CHOCO MÜFFÝN	GIDA	BÜSKÝVÝ ÇEREZ	KEK	4
16	27	8	2	27	MARKA-210	000027	KEK H.CEVÝZLÝ 48GR	GIDA	BÜSKÝVÝ ÇEREZ	KEK	4
16	28	8	2	19	MARKA-210	000019	ÞEKER 50 GR PORTAKAL	GIDA	SAKIZ SEKERLEME	ÞEKERLEME	4
------------------  13 ROW
16	29	8	3	20	MARKA-210	000020	ÞEKER 50 GR ÇÝLEKLÝ	GIDA	SAKIZ SEKERLEME	ÞEKERLEME	4

*/

-- Gruplar da bölünüp sýralandýrýlabilinir
-- Her bir marka kendi içinde 3 parçaya ayrýldý birim satýþ fiyatýna göre
Select RANK() OVER
		(PARTITION BY BRAND ORDER BY UNITPRICE ) AS RANK_ ,
		ROW_NUMBER() OVER
		(PARTITION BY BRAND ORDER BY UNITPRICE ) AS ROWNUMBER ,
		DENSE_RANK() OVER
		(PARTITION BY BRAND ORDER BY UNITPRICE ) AS DENSE_RANK_,
		NTILE(3) OVER
		(PARTITION BY BRAND ORDER BY UNITPRICE ) AS NTILE5_,*
FROM ITEMS

/*

1	1	1	1	1274	MARKA-01	001274	KOKTEYL YEÞÝL ZEYTÝN 200 GR	SÜT KAHVALTILIK	ZEYTÝN	YEÞÝL ZEYTÝN	10,4
2	2	2	1	886	MARKA-01	000886	KÖZLENMÝÞ KIRMIZI BÝBER 650 GR	GIDA	HAZIR YEMEKLER	SÝRKE SOS	25,2
3	3	3	1	1128	MARKA-01	001128	GEMLÝK SÝYAH ZEYTÝN 400 GR	SÜT KAHVALTILIK	ZEYTÝN	SÝYAH ZEYTÝN	26,8

4	4	4	2	1340	MARKA-01	001340	EXTRA GEMLÝK SÝYAH ZEYTÝN 400 GR	SÜT KAHVALTILIK	ZEYTÝN	SÝYAH ZEYTÝN	28
5	5	5	2	1338	MARKA-01	001338	LUX GEMLÝK SÝYAH ZEYTÝN 800 GR	SÜT KAHVALTILIK	ZEYTÝN	SÝYAH ZEYTÝN	43,6

6	6	6	3	1339	MARKA-01	001339	EXTRA GEMLÝK SÝYAH ZEYTÝN 800 GR	SÜT KAHVALTILIK	ZEYTÝN	SÝYAH ZEYTÝN	50
7	7	7	3	326	MARKA-01	000326	HIYAR TURÞUSU 3100 GR	GIDA	HAZIR YEMEKLER	TURÞU	54,8

1	1	1	1	315	MARKA-02	000315	SÜT YARIM YAÐLI 1 LT	SÜT KAHVALTILIK	SÜT	PASTÖRÝZE SÜT	13,52
2	2	2	1	317	MARKA-02	000317	BUÐDAY UN 1 KG	GIDA	UNLU MAMÜLLER	UN	14
3	3	3	1	325	MARKA-02	000325	ÞU 10 LT	ÝÇECEK	SU MADENSUYU	SU	20
4	4	4	1	320	MARKA-02	000320	GELENEKSEL KAYISI REÇELÝ 380 GR	SÜT KAHVALTILIK	KAHVALTILIK	REÇEL	21,52
5	5	5	1	324	MARKA-02	000324	KAKAOLU FINDIK KREMASI DUO400GR	SÜT KAHVALTILIK	KAHVALTILIK	KREM ÇÝKOLATA	22,8

6	6	6	2	321	MARKA-02	000321	KOVA REÇEL 1 KG VÝÞNE	SÜT KAHVALTILIK	KAHVALTILIK	REÇEL	43,12
6	7	6	2	322	MARKA-02	000322	KOVA REÇEL 1 KG KAYISI	SÜT KAHVALTILIK	KAHVALTILIK	REÇEL	43,12
8	8	7	2	319	MARKA-02	000319	FÝLÝZ ÇAY 500GR	ÝÇECEK	ÇAY KAHVE	ÇAY	44
9	9	8	2	323	MARKA-02	000323	ÜZÜM PEKMEZÝ 700 GR	SÜT KAHVALTILIK	KAHVALTILIK	TAHÝN PEKMEZ	55,2
10	10	9	2	981	MARKA-02	000981	AYÇÝÇEK YAÐI 2 LT	GIDA	SIVI YAÐLAR	AYÇÝÇEK	61,52

11	11	10	3	318	MARKA-02	000318	ÇAY 1000 GR	ÝÇECEK	ÇAY KAHVE	ÇAY	63,2
12	12	11	3	316	MARKA-02	000316	BUÐDAY UNU 10 KG	GIDA	UNLU MAMÜLLER	UN	116
13	13	12	3	1126	MARKA-02	001126	TAZE KAÞAR PEYNÝRÝ 1000 GR	SÜT KAHVALTILIK	PEYNÝR	KAÞAR PEYNÝRÝ	126
14	14	13	3	980	MARKA-02	000980	AYÇÝÇEK YAÐI 5 LT PET	GIDA	SIVI YAÐLAR	AYÇÝÇEK	147,6

1	1	1	1	338	MARKA-03	000338	PLASTÝK ÇATAL 10 ADET	EV	MUTFAK EÞYA GEREÇLERÝ	MUTFAK SARF MALZEMESÝ	4
1	2	1	1	339	MARKA-03	000339	PLASTÝK KAÞIK 10 ADET	EV	MUTFAK EÞYA GEREÇLERÝ	MUTFAK SARF MALZEMESÝ	4
3	3	2	1	337	MARKA-03	000337	SÜNGER 3LU OLUKLU	DETERJAN TEMÝZLÝK	EV TEMÝZLÝK GEREÇLERÝ	TEMÝZLÝK AMAÇLI BEZLER	6
4	4	3	1	341	MARKA-03	000341	BUZDOLABI POÞETÝ ORTA 50 ADET	EV	MUTFAK EÞYA GEREÇLERÝ	MUTFAK SARF MALZEMESÝ	6,8
5	5	4	1	336	MARKA-03	000336	TEMÝZLÝK BEZÝ 3LU	DETERJAN TEMÝZLÝK	EV TEMÝZLÝK GEREÇLERÝ	TEMÝZLÝK AMAÇLI BEZLER	7,2
6	6	5	1	334	MARKA-03	000334	KREM TEMÝZLEYÝCÝ 500ML LÝMONLU	DETERJAN TEMÝZLÝK	EV TEMÝZLEYÝCÝ	MUTFAK BANYO TEMÝZLEYÝCÝ	12,72
7	7	6	1	329	MARKA-03	000329	BULAÞIK DETERJANI 750ML 	DETERJAN TEMÝZLÝK	BULAÞIK YIKAMA	ELDE YIKAMA	13,2

8	8	7	2	1130	MARKA-03	001130	CAM TEMÝZLEYÝCÝ 750 ML	DETERJAN TEMÝZLÝK	EV TEMÝZLEYÝCÝ	CAM PARLAK YÜZEY	14,32
9	9	8	2	333	MARKA-03	000333	YÜZEY TEMÝZLEYÝCÝ 1LT LAVANTA	DETERJAN TEMÝZLÝK	EV TEMÝZLEYÝCÝ	YÜZEY TEMÝZLEYÝCÝ	15,92
10	10	9	2	330	MARKA-03	000330	SIVI EL SABUNU DENÝZ ESÝNTÝSÝ 1000ML	KOZMETÝK	DUÞ BANYO	SIVI JEL SABUNLAR	18
11	11	10	2	982	MARKA-03	000982	ÇÖP TORBASI BÜZG BÜYÜK BOY LAVANTAKOKULU	EV	MUTFAK EÞYA GEREÇLERÝ	MUTFAK SARF MALZEMESÝ	20
12	12	11	2	340	MARKA-03	000340	ALUMÝNYUM FOLYO 15 METRE	EV	MUTFAK EÞYA GEREÇLERÝ	MUTFAK SARF MALZEMESÝ	22
13	13	12	2	335	MARKA-03	000335	ÇAMAÞIR SUYU 4 LT	DETERJAN TEMÝZLÝK	ÇAMAÞIR YIKAMA	ÇAMAÞIR SULARI	23,6
14	14	13	2	1129	MARKA-03	001129	AHÞAP TEMÝZLEYÝCÝSÝ 1 LT	DETERJAN TEMÝZLÝK	EV TEMÝZLEYÝCÝ	AHÞAP TEMÝZLEYÝCÝ	23,92

15	15	14	3	328	MARKA-03	000328	ÇAMAÞIR MAK. KÝREÇ ÖNLEYÝCÝ 500GR	DETERJAN TEMÝZLÝK	ÇAMAÞIR YIKAMA	ÇAMAÞIR KATKILARI	26,32
16	16	15	3	1275	MARKA-03	001275	MANGAL KÖMÜRÜ 1KG	EV	MUTFAK EÞYA GEREÇLERÝ	PÝÞÝRME GEREÇLERÝ	31,2
17	17	16	3	331	MARKA-03	000331	SIVI SABUN BAHAR FERAHLIÐI 2500ML	KOZMETÝK	DUÞ BANYO	SIVI JEL SABUNLAR	38
17	18	16	3	332	MARKA-03	000332	SIVI SABUN DOÐAL ESÝNTÝ 2500ML	KOZMETÝK	DUÞ BANYO	SIVI JEL SABUNLAR	38
19	19	17	3	299	MARKA-03	000299	YUMUÞATICI 6 LT	DETERJAN TEMÝZLÝK	ÇAMAÞIR YIKAMA	ÇAMAÞIR YUMUÞATICI	39,2
20	20	18	3	342	MARKA-03	000342	KAPI ONU PASPAS	EV	EV TEKSTÝL	MUTFAK	63,2
21	21	19	3	327	MARKA-03	000327	6 LT YUMUÞATICI LAVANTA	DETERJAN TEMÝZLÝK	ÇAMAÞIR YIKAMA	ÇAMAÞIR YUMUÞATICI	70

1	1	1	1	629	MARKA-04	000629	150 ML DEO FOR MEN OCEAN BLUE	KOZMETÝK	PARFÜM DEODORANT	DEODORANT	55,6
2	2	2	2	660	MARKA-04	000660	ROLLON 50 ML MODERN	KOZMETÝK	PARFÜM DEODORANT	ROLL-ON	58
3	3	3	3	627	MARKA-04	000627	150 ML KADIN	KOZMETÝK	PARFÜM DEODORANT	DEODORANT	60

*/